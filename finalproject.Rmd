---
title: "finalproject"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(plotly)
```

####Loading and tidying the Yelp business dataset

```{r}
business <- read_csv("./data/business.csv") %>% 
  mutate(name = str_sub(name, 2, -2)) %>% 
  mutate(address = str_sub(address, 2, -2))

categories <- business %>% 
  select(business_id, categories) %>% 
  separate(categories, into = c("cat1", "cat2", "cat3", "cat4", "cat5", "cat6", "cat7", "cat8", "cat9", "cat10", "cat11", "cat12", "cat13", "cat14", "cat15", "cat16", "cat17", "cat18", "cat19", "cat20", "cat21", "cat22", "cat23", "cat24", "cat25"), sep  = ";") %>% 
  gather(key = "cat_id", value = "category", starts_with("cat")) %>% 
  select(-cat_id) 
  
restaurant_ids <- categories %>% 
  filter(category == "Restaurants" | category == "Food") %>% 
  distinct(business_id)

restaurants <- business %>% 
  left_join(restaurant_ids, by = "business_id") %>% 
  select(-categories)

rm(restaurant_ids)
rm(business)
```

####Loading and tidying the attributes dataset

```{r}
attributes <- read_csv("./data/attributes.csv") %>% 
  janitor::clean_names() %>% 
  select(business_id, alcohol)
```

####Joining the business and attributes datasets

```{r}
restaurants <- restaurants %>% 
  left_join(attributes, by = "business_id")
```

####Creating a plotly of restaurant locations

Center of Las Vegas: 36.1699° N, 115.1398° W. Plotly displayed is surrounds this center by 0.5 degrees longitude and latitude.

```{r}
restaurants %>% 
  filter(latitude > 35.6699 & latitude < 36.6699) %>% 
  filter(longitude < -114.6398 & longitude > -115.6398) %>%
  plot_ly(x = ~longitude, y = ~latitude, type = "scatter", mode = "markers",
          alpha = 0.5, 
          color = ~stars) %>%
  layout(xaxis = list(title = "Longitude"),
         yaxis = list(title = "Latitude"))
```

##### regress stuff
```{r}



```

